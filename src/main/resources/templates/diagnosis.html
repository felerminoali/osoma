<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout-no-header}">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <!-- Custom Theme files -->

</head>
<th:block layout:fragment="content">
    <div id="MathJax_Message" style="display: none;"></div>

    <div class="container">

        <div class="row">
            <!--Main content-->
            <div class="col-md-12" style="background-color: white; border: 1px solid #c2cbd4;">

                <div class="classmarker_body_div">

                    <div id="ajax-container">


                        <div class="failx"></div>


                        <h3>Diagnostico</h3>
                        <div class="clearheight5"></div>

                        <div class="quiz_timer_container">

                            <script type="text/javascript" src="/js/online-test.js"></script>

                            <div id="status"><strong>Tempo remanescente: </strong>00:00:10<br>
                                <div class="progress">
                                    <div class="progress-bar progress-bar-danger" role="progressbar" aria-valuenow="70"
                                         aria-valuemin="0" aria-valuemax="100" style="width:70%"></div>
                                </div>
                            </div>

                            <script type="text/javascript">
                                var maxSec = "20";
                            </script>

                            <script type="text/javascript">
                                var secods = getCookie("seconds");

                                if (secods == "") {
                                    secods = maxSec;
                                }
                                countDown(secods, maxSec, "status");
                            </script>

                        </div>
                        <form action="/ubs/results" method="post" autocomplete="off" id="questionform">
                            <input type="hidden" id="timeoutinput" name="na1" value="na">
                            <input type="hidden" id="finishnowinput" name="na2" value="na">
                            <input type="hidden" id="examid" name="examid" th:value="${id}">
                            <input type="hidden" id="starttimestamp" name="starttimestamp" th:value="${starttimestamp}">


                            <div id="question_container">
                                <a id="q123"></a>

                                <div class="single_question_box">

                                    <div class="qbox">
                                        <div class="qboxleft">
                                            <div id="paging"><h4>Quest√£o <span th:text="${next}">1</span> de <span
                                                    th:text="${quantidadeExames}"></span></h4></div>
                                        </div>
                                        <div class="clear"></div>
                                    </div>
                                    <div class="col600 qsholder editor">
                                        <p>
                                        </p>
                                        <dl id="question_div">
                                            <dd class="q_question">

                                                <!--<div class="span6 pull-left">-->
                                                <!--<span style="display: inline;" th:text="${questions.question}">:</span>-->
                                                <!--</div>-->

                                                <div class="media">
                                                    <div class="media-left" th:if="${questions.image}!=null">
                                                        <a href="#">
                                                            <img class="media-object" src="${questions.image}" alt="${questions.image}">
                                                        </a>
                                                    </div>
                                                    <div class="media-body">
                                                        <h4 class="media-heading"><span style="display: inline;"
                                                                                        th:text="${questions.question}">:</span>
                                                        </h4>
                                                        <br/>
                                                        <div class="span6 pull-left" th:if="${questions.extratext}!=null">

                                                            <div class="casestudy" th:utext="${shortText}"></div>

                                                            <!-- Modal -->
                                                            <div class="modal fade" id="myModal" tabindex="-1"
                                                                 role="dialog" aria-labelledby="myModalLabel">
                                                                <div class="modal-dialog modal-lg" role="document">
                                                                    <div class="modal-content">
                                                                        <div class="modal-header">
                                                                            <button type="button" class="close"
                                                                                    data-dismiss="modal"
                                                                                    aria-label="Close"><span
                                                                                    aria-hidden="true">&times;</span>
                                                                            </button>
                                                                            <h4 class="modal-title" id="myModalLabel">
                                                                                Texto</h4>
                                                                        </div>
                                                                        <div class="modal-body" th:utext="${htmlCaseOfStudy}"></div>
                                                                        <div class="modal-footer">
                                                                            <button type="button"
                                                                                    class="btn btn-default"
                                                                                    data-dismiss="modal">Close
                                                                            </button>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>


                                                        </div>
                                                    </div>
                                                </div>

                                            </dd>
                                        </dl>
                                        <p></p>
                                    </div>
                                    <div class="dotted"></div>
                                    <div class="answersDiv">
                                        <table width="100%">
                                            <tr th:each="alternative: ${choices}">
                                                <div class="clear"></div>
                                                <div class="ans_select">
                                                    <input type="radio" th:id="${'q_'+questions.id+'_'+alternative.id}"
                                                           name="q_choice" th:checked="${alternative.id == sessionAnswer}">
                                                </div>
                                                <div class="ans_content editor">
                                                    <label th:for="${'q_'+questions.id+'_'+alternative.id}">
                                                        <span th:text="${alternative.answer}">.</span>
                                                    </label>
                                                </div>
                                            </tr>
                                        </table>
                                    </div>

                                </div>


                            </div>


                            <div class="nextprev">
                                <div class="prevbox">
                                    <div class="prevbox">
                                        <a th:if="${next}>1" th:href="@{/online-test(id = ${id}, question = ${next-2})}"
                                           id="qprev" class="btn btn-danger prev"><i
                                                class="glyphicon glyphicon-chevron-left"></i> Anterior</a>
                                    </div>
                                </div>
                                <div class="nextbox">
                                    <a th:if="${next<quantidadeExames}"
                                       th:href="@{/online-test(id = ${id}, question = ${next})}"
                                       id="qnext" class="btn btn-danger next">Seguinte
                                        <i class="glyphicon glyphicon-chevron-right"></i>
                                    </a>
                                    <a th:if="${next}>=${quantidadeExames}" id="qfinish"
                                       class="btn btn-success t_finish">
                                        Terminar teste
                                        <i class="glyphicon glyphicon-chevron-right"></i>
                                    </a>
                                </div>

                            </div>
                        </form>

                        <script type="text/javascript">





                            if ($('.t_finish').length > 0) {
                                ($('.t_finish').click(function () {
                                    checkAndSave();

                                }));
                            }

                            if ($('.next').length > 0) {
                                ($('.next').click(function () {
                                    checkAndSave();
                                }));
                            }

                            if ($('.prev').length > 0) {
                                ($('.prev').click(function () {
                                    checkAndSave();
                                }));
                            }

                            function shortenString() {
                                var str = $(".casestudy").html();

                                if (str.length > 120) {
                                    var res = str.substring(0, 120);

                                    $(".casestudy").html(res);

                                    var strModal = '<p>' + str + '</p>';
                                    $(".modal-body").html(strModal);

                                }
                            }
                        </script>
                    </div>


                </div>

            </div>


        </div>
    </div>
</th:block>
</html>